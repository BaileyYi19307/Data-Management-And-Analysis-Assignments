# Homework 06 — Single Table, Import, and SQL (PostgreSQL)

Load a cleaned CSV into PostgreSQL, design a single-table schema, and run basic-to-intermediate SQL queries.

## Overview
- **Data:** 2018 Central Park Squirrel Census — Squirrel Data  
  Source: https://data.cityofnewyork.us/Environment/2018-Central-Park-Squirrel-Census-Squirrel-Data/vfnx-vebw/about_data  
- **Goal:** Convert/clean CSV, create a table, import data, and query for insights.

## Repository Structure
```

hw06/
├── README.md
├── convert.ipynb            # builds cleaned CSV from raw data
├── squirrel_census.csv      # cleaned CSV (generated by convert.ipynb)
├── create_table.sql         # DROP/CREATE table (types, constraints)
├── import_csv.sql           # \copy command for client-side import
└── queries.sql              # all assignment queries (with labels)

````

## Setup
1. **Install PostgreSQL**
   - macOS: `brew install postgresql`  
   - Start service: `brew services start postgresql`

2. **Create database**
   ```bash
   createdb homework06
   psql homework06
````

3. **Create table**

   ```sql
   \i create_table.sql
   ```

4. **Import data**
   Use client-side import (`\copy`) so the file path is resolved on your machine (not the server):

   ```sql
   \i import_csv.sql
   ```

   **Note:** If you see `COPY FROM` path errors, switch to `\copy` (already used here).

## Schema

`create_table.sql`

```sql
DROP TABLE IF EXISTS squirrel_data;
CREATE TABLE squirrel_data (
    id SERIAL PRIMARY KEY,
    primary_fur_color TEXT,
    above_ground_sighter_measurement INT,
    date DATE,
    longitude FLOAT,
    latitude FLOAT,
    above_or_below_ground TEXT
);
```

## Data Preparation

`convert.ipynb`

* Selects relevant columns
* Renames columns (e.g., `X`→`Longitude`, `Y`→`Latitude`, `Location`→`AboveOrBelowGround`)
* Converts `Date` (MMDDYYYY) to SQL `DATE`
* Normalizes `"Above Ground Sighter Measurement"` (e.g., `"FALSE"` → `0`)
* Saves to `squirrel_census.csv`

## Import Notes

* **Fixed:** `COPY FROM` permission/path error by using `\copy` (client-side).
* Keep `squirrel_census.csv` in the same directory as `import_csv.sql` or update the path in `import_csv.sql`.

`import_csv.sql`

```sql
\copy squirrel_data(
    primary_fur_color,
    above_ground_sighter_measurement,
    date,
    longitude,
    latitude,
    above_or_below_ground
)
FROM 'squirrel_census.csv'
DELIMITER ','
CSV HEADER;
```

## Database Information (examples)

Inside `psql`:

```sql
\l           -- list databases
\dt          -- list tables
\d squirrel_data   -- describe table
```

## Queries

All queries are in `queries.sql` with numbered labels:

* **1** Total rows
* **2–3** First 15 rows (3 columns), then sorted
* **4–5** Add a column and set its values
* **6** Distinct values of a column
* **7–8** Group + aggregate, then filter groups with `HAVING`
* **9–12** Additional analysis (max, avg, conditional counts, busiest date)

Example (from `queries.sql`):

```sql
-- 1. the total number of rows in the database
SELECT COUNT(id) FROM squirrel_data;

-- 7. group by primary fur color and count
SELECT primary_fur_color, COUNT(*)
FROM squirrel_data
GROUP BY primary_fur_color;

-- 12. day with most sightings
SELECT date, COUNT(*) AS sighting_count
FROM squirrel_data
GROUP BY date
ORDER BY sighting_count DESC
LIMIT 1;
```

## How to Reproduce

```bash
psql homework06 -f create_table.sql
psql homework06 -f import_csv.sql
psql homework06 -f queries.sql
```

```

